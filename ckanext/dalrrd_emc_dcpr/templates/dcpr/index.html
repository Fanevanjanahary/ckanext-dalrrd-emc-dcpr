{% extends "page.html" %}

{% set able_to_create_request = h.check_access('dcpr_request_create_auth') %}

{% block subtitle %}{{ _('DCPR Requests') }} - {{ super() }}{% endblock %}

{# lets only show those nav links that the current user is able to navigate to and do something useful #}
{% block secondary_content %}
    <nav role="navigation">
        <ul class="nav nav-pills nav-stacked">
            <li role="presentation" class="active">
                {% link_for _('Public DCPR requests'), named_route='dcpr.get_public_dcpr_requests' %}
            </li>
            {% if able_to_create_request %}
                <li role="presentation">
                    {% link_for _('Unsubmitted DCPR requests'), named_route='dcpr.get_unsubmitted_dcpr_requests' %}
                </li>
            {% endif %}
            <li role="presentation">
                {% link_for _('Requests awaiting CSI moderation'), named_route='dcpr.get_awaiting_csi_moderation_dcpr_requests' %}
            </li>
            <li role="presentation">
                {% link_for _('Requests awaiting NSIF moderation'), named_route='dcpr.get_awaiting_nsif_moderation_dcpr_requests' %}
            </li>
        </ul>
    </nav>
{% endblock %}

{% block primary_content %}
    <h1>Data Capture Project Registry</h1>
    <p>The Data Capture Project Registry (DCPR) contains a listing of all data capture requests</p>
    <section class="module">
        <div class="module-content">
            {% block page_primary_action %}
                {% if able_to_create_request %}
                    <div class="page_primary_action">
                        {% link_for _('Create request'), named_route='dcpr.new_dcpr_request', class_='btn btn-primary', icon='plus-square' %}
                    </div>
                {% endif %}
            {% endblock %}

            {% if public_requests %}
                <ul class="{{ list_class or 'dataset-list list-unstyled' }}">
                    {% for request in public_requests %}
                        {% snippet 'dcpr/snippets/request_item.html', dcpr_request=request, request_status=statuses %}
                    {% endfor %}
                </ul>
            {% else %}
                <div>
                    <h5> {{ _('There are no public DCPR requests yet') }}</h5>
                </div>
            {% endif %}

        </div>
    </section>
{% endblock %}

{#{% block secondary_content %}#}
{#    {% snippet 'dcpr/snippets/info.html', dcpr_requests=dcpr_requests %}#}
{#{% endblock%}#}
